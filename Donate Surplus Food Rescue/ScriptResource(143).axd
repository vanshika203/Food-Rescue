// (c) 2010 CodePlex Foundation
(function(){function n(){Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.ResizableControlBehavior=function(n){Sys.Extended.UI.ResizableControlBehavior.initializeBase(this,[n]);this._HandleCssClass="";this._ResizableCssClass="";this._HandleOffsetX=0;this._HandleOffsetY=0;this._MinimumWidth=0;this._MinimumHeight=0;this._MaximumWidth=1e5;this._MaximumHeight=1e5;this._frame=null;this._handle=null;this._handleHolder=null;this._lining=null;this._tracking=!1;this._lastClientX=0;this._lastClientY=0;this._onmouseoverDelegate=null;this._onmouseoutDelegate=null;this._onmousedownDelegate=null;this._onmousemoveDelegate=null;this._onmouseupDelegate=null;this._onselectstartDelegate=null};Sys.Extended.UI.ResizableControlBehavior.prototype={initialize:function(){var n,t;Sys.Extended.UI.ResizableControlBehavior.callBaseMethod(this,"initialize");this._frame=this.get_element();n=Sys.Extended.UI.ResizableControlBehavior.callBaseMethod(this,"get_ClientState");n&&-1!=n.indexOf(",")&&(t=n.split(","),this._frame.style.width=t[0]+"px",this._frame.style.height=t[1]+"px");this._lining=document.createElement("DIV");this._lining.style.width=$common.getCurrentStyle(this._frame,"width");this._lining.style.height=$common.getCurrentStyle(this._frame,"height");this._lining.style.position="absolute";this._lining.style.backgroundColor="black";this._lining.style.opacity="0";this._lining.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)";this._lining.style.visibility="hidden";this._frame.insertBefore(this._lining,this._frame.firstChild);this._handleHolder=document.createElement("DIV");this._handleHolder.style.width="0px";this._handleHolder.style.height="0px";this._handleHolder.style.position=Sys.Browser.agent===Sys.Browser.Opera?"relative":"absolute";this._frame.insertBefore(this._handleHolder,this._frame.firstChild);this._handle=document.createElement("DIV");this._handle.className=this._HandleCssClass;this._handle.style.position="absolute";this._handleHolder.appendChild(this._handle);this._onmouseoverDelegate=Function.createDelegate(this,this._onmouseover);$addHandler(this._handle,"mouseover",this._onmouseoverDelegate);this._onmouseoutDelegate=Function.createDelegate(this,this._onmouseout);$addHandler(this._handle,"mouseout",this._onmouseoutDelegate);this._onmousedownDelegate=Function.createDelegate(this,this._onmousedown);$addHandler(this._handle,"mousedown",this._onmousedownDelegate);this._onmousemoveDelegate=Function.createDelegate(this,this._onmousemove);this._onmouseupDelegate=Function.createDelegate(this,this._onmouseup);this._onselectstartDelegate=Function.createDelegate(this,this._onselectstart);this._resizeControl(0,0,0,0);this._rememberSize()},dispose:function(){this._onmouseoverDelegate&&($removeHandler(this._handle,"mouseover",this._onmouseoverDelegate),this._onmouseoverDelegate=null);this._onmouseoutDelegate&&($removeHandler(this._handle,"mouseout",this._onmouseoutDelegate),this._onmouseoutDelegate=null);this._onmousedownDelegate&&($removeHandler(this._handle,"mousedown",this._onmousedownDelegate),this._onmousedownDelegate=null);this._onmousemoveDelegate&&(this.tracking&&$removeHandler(document,"mousemove",this._onmousemoveDelegate),this._onmousemoveDelegate=null);this._onmouseupDelegate&&(this.tracking&&$removeHandler(document,"mouseup",this._onmouseupDelegate),this._onmouseupDelegate=null);this._onselectstartDelegate&&(this.tracking&&($removeHandler(document,"selectstart",this._onselectstartDelegate),Sys.Browser.agent===Sys.Browser.Opera&&$removeHandler(document,"mousedown",this._onselectstartDelegate)),this._onselectstartDelegate=null);Sys.Extended.UI.ResizableControlBehavior.callBaseMethod(this,"dispose")},_onmouseover:function(){Sys.UI.DomElement.addCssClass(this._frame,this._ResizableCssClass)},_onmouseout:function(){this._tracking||Sys.UI.DomElement.removeCssClass(this._frame,this._ResizableCssClass)},_onmousedown:function(n){n||(n=event);this._onmousedownImplementation(n.clientX,n.clientY)},_onmousedownImplementation:function(n,t){this._tracking=!0;this._resizeControl(n,t,0,0);this._lining.style.visibility="visible";$addHandler(document,"mousemove",this._onmousemoveDelegate);$addHandler(document,"mouseup",this._onmouseupDelegate);$addHandler(document,"selectstart",this._onselectstartDelegate);Sys.Browser.agent===Sys.Browser.Opera&&$addHandler(document,"mousedown",this._onselectstartDelegate);this.raiseResizeBegin()},_onmousemove:function(n){n||(n=event);this._onmousemoveImplementation(n.clientX,n.clientY)},_onmousemoveImplementation:function(n,t){if(this._tracking){var i=n-this._lastClientX,r=t-this._lastClientY;this._resizeControl(n,t,i,r)}},_onmouseup:function(){this._tracking=!1;this._rememberSize();this._lining.style.visibility="hidden";$removeHandler(document,"mousemove",this._onmousemoveDelegate);$removeHandler(document,"mouseup",this._onmouseupDelegate);$removeHandler(document,"selectstart",this._onselectstartDelegate);Sys.Browser.agent===Sys.Browser.Opera&&$removeHandler(document,"mousedown",this._onselectstartDelegate);Sys.UI.DomElement.removeCssClass(this._frame,this._ResizableCssClass)},_onselectstart:function(n){return n.preventDefault(),!1},_resizeControl:function(n,t,i,r){var u,f,e,o;this._lastClientX=n;this._lastClientY=t;u=Math.min(Math.max(this._lining.offsetWidth+i,Math.max(this._MinimumWidth,this._handle.offsetWidth)),this._MaximumWidth);f=Math.min(Math.max(this._lining.offsetHeight+r,Math.max(this._MinimumHeight,this._handle.offsetHeight)),this._MaximumHeight);this._lining.style.width=u+"px";this._lining.style.height=f+"px";this._frame.style.width=u+"px";this._frame.style.height=f+"px";e=this._lining.offsetWidth-this._handle.offsetWidth+this._HandleOffsetX;o=this._lining.offsetHeight-this._handle.offsetHeight+this._HandleOffsetY;this._handle.style.left=e+"px";this._handle.style.top=o+"px";this.raiseResizing()},_rememberSize:function(){var n=this.get_Size();Sys.Extended.UI.ResizableControlBehavior.callBaseMethod(this,"set_ClientState",[n.width+","+n.height]);this.raiseResize()},_measurementToNumber:function(n){return n.replace("px","")},get_HandleCssClass:function(){return this._HandleCssClass},set_HandleCssClass:function(n){if(this._HandleCssClass)throw String.format(Sys.Extended.UI.Resources.ResizableControlBehavior_CannotChangeProperty,"HandleCssClass");this._HandleCssClass=n;this.raisePropertyChanged("HandleCssClass")},get_ResizableCssClass:function(){return this._ResizableCssClass},set_ResizableCssClass:function(n){if(this._ResizableCssClass)throw String.format(Sys.Extended.UI.Resources.ResizableControlBehavior_CannotChangeProperty,"ResizableCssClass");this._ResizableCssClass=n;this.raisePropertyChanged("ResizableCssClass")},get_HandleOffsetX:function(){return this._HandleOffsetX},set_HandleOffsetX:function(n){this._HandleOffsetX!=n&&(this._HandleOffsetX=n,this.raisePropertyChanged("HandleOffsetX"))},get_HandleOffsetY:function(){return this._HandleOffsetY},set_HandleOffsetY:function(n){this._HandleOffsetY!=n&&(this._HandleOffsetY=n,this.raisePropertyChanged("HandleOffsetY"))},get_MinimumWidth:function(){return this._MinimumWidth},set_MinimumWidth:function(n){this._MinimumWidth!=n&&(this._MinimumWidth=n,this.raisePropertyChanged("MinimumWidth"))},get_MinimumHeight:function(){return this._MinimumHeight},set_MinimumHeight:function(n){this._MinimumHeight!=n&&(this._MinimumHeight=n,this.raisePropertyChanged("MinimumHeight"))},get_MaximumWidth:function(){return this._MaximumWidth},set_MaximumWidth:function(n){this._MaximumWidth!=n&&(this._MaximumWidth=n,this.raisePropertyChanged("MaximumWidth"))},get_MaximumHeight:function(){return this._MaximumHeight},set_MaximumHeight:function(n){this._MaximumHeight!=n&&(this._MaximumHeight=n,this.raisePropertyChanged("MaximumHeight"))},add_resizing:function(n){this.get_events().addHandler("resizing",n)},remove_resizing:function(n){this.get_events().removeHandler("resizing",n)},raiseResizing:function(){var n=this.get_events().getHandler("resizing");n&&n(this,Sys.EventArgs.Empty)},get_resizing:function(){return this.get_events().getHandler("resizing")},set_resizing:function(n){if(n&&0<n.length){var t=$common.resolveFunction(n);if(t)this.add_resizing(t);else throw Error.argumentType("value",typeof n,"Function",String.format(Sys.Extended.UI.Resources.ResizableControlBehavior_InvalidHandler,"resizing"));}},add_resize:function(n){this.get_events().addHandler("resize",n)},remove_resize:function(n){this.get_events().removeHandler("resize",n)},raiseResize:function(){var n=this.get_events().getHandler("resize");n&&n(this,Sys.EventArgs.Empty)},get_resize:function(){return this.get_events().getHandler("resize")},set_resize:function(n){if(n&&0<n.length){var t=$common.resolveFunction(n);if(t)this.add_resize(t);else throw Error.argumentType("value",typeof n,"Function",String.format(Sys.Extended.UI.Resources.ResizableControlBehavior_InvalidHandler,"resize"));}},add_resizebegin:function(n){this.get_events().addHandler("resizebegin",n)},remove_resizebegin:function(n){this.get_events().removeHandler("resizebegin",n)},raiseResizeBegin:function(){var n=this.get_events().getHandler("resizebegin");n&&n(this,Sys.EventArgs.Empty)},get_resizebegin:function(){return this.get_events().getHandler("resizebegin")},set_resizebegin:function(n){if(n&&0<n.length){var t=$common.resolveFunction(n);if(t)this.add_resizebegin(t);else throw Error.argumentType("value",typeof n,"Function",String.format(Sys.Extended.UI.Resources.ResizableControlBehavior_InvalidHandler,"resizebegin"));}},get_Size:function(){return{width:this._measurementToNumber($common.getCurrentStyle(this._lining,"width")),height:this._measurementToNumber($common.getCurrentStyle(this._lining,"height"))}},set_Size:function(n){var t=n.width-this._measurementToNumber($common.getCurrentStyle(this._lining,"width")),i=n.height-this._measurementToNumber($common.getCurrentStyle(this._lining,"height"));this._resizeControl(0,0,t,i);this._rememberSize();this.raisePropertyChanged("Size")}};Sys.Extended.UI.ResizableControlBehavior.registerClass("Sys.Extended.UI.ResizableControlBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.ResizableControlBehavior,{name:"resizable"})}window.Sys&&Sys.loader?Sys.loader.registerScript("ExtendedResizable",["ExtendedBase","ExtendedCommon"],n):n()})();