Type.registerNamespace("Sys.Extended.UI.HTMLEditor.ToolbarButton");Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles=function(n){Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.initializeBase(this,[n])};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.prototype={callMethod:function(){if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.callBaseMethod(this,"callMethod"))return!1;var n=this._designPanel;setTimeout(function(){var ct=Sys.Extended.UI.HTMLEditor.isIE?"":Sys.Extended.UI.HTMLEditor.Trim(n.getSelectedHTML()),s=n._getSelection(),f=n._createRange(s),i=null,ft=!1,h,e,ot,it,r,p,k,st,v,nt,d,o,c,u,l,a,y,tt,ut,t;if(!n.isControl()&&(Sys.Extended.UI.HTMLEditor.isIE&&f.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&ct.length>0)?i=n._getTextNodeCollection():(i=n._tryExpand(),ft=!0),i!=null&&i.length>0){var et=!1,y=!0;for(n._saveContent(),h=n._doc.createElement("span"),h.id="_left_",e=n._doc.createElement("span"),e.id="_right_",ot=i[0].parentNode,it=i[i.length-1].parentNode,ot.insertBefore(h,i[0]),i[i.length-1].nextSibling?it.insertBefore(e,i[i.length-1].nextSibling):it.appendChild(e);y;)for(y=!1,o=0;o<i.length;o++)if(r=i[o].parentNode,r&&i[o].previousSibling==null&&i[o].nextSibling==null&&(p=r.tagName.toUpperCase(),Sys.Extended.UI.HTMLEditor.isStyleTag(p)&&p!="A"&&(r.className!=Sys.Extended.UI.HTMLEditor.smartClassName||p.substr(0,1)=="H")))if(k=Sys.Extended.UI.HTMLEditor.differAttr(r,["class","color","face","size"]),et=!0,k.length==0){var v=r.parentNode,c=r.firstChild?r.firstChild:null,g=null;if(p.toUpperCase().substr(0,1)=="H"&&Sys.Extended.UI.HTMLEditor.isIE)for(g=n._doc.createElement("p"),g.className=Sys.Extended.UI.HTMLEditor.smartClassName,v.insertBefore(g,r);r.firstChild;)g.appendChild(r.firstChild);else{while(r.firstChild)v.insertBefore(r.firstChild,r);p.toUpperCase().substr(0,1)=="H"&&(st=n._doc.createElement("br"),v.insertBefore(st,r))}v.removeChild(r);y=!0}else{for(v=r.parentNode,nt=n._doc.createElement(p),d=0;d<k.length;d++)nt.setAttribute(k[d][0],k[d][1]);for(v.insertBefore(nt,r);r.firstChild;)nt.appendChild(r.firstChild);v.removeChild(r)}for(o=0;o<i.length;o++)if(c=i[o],u=i[o].parentNode!=null&&typeof i[o].parentNode!="undefined"?i[o].parentNode:null,u){for(l=null;u&&u.tagName&&u.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HTMLEditor.isStyleTag(u.tagName)&&u.tagName.toUpperCase()!="A"&&Sys.Extended.UI.HTMLEditor.differAttr(u,["class","color","face","size"]).length==0;)l=u,u=u.parentNode;if(l){et=!0;function rt(n,t,i,r){var u=i.cloneNode(!1),e,c,s,o,h,f;if(n)if(n.push&&typeof n.push=="function")for(e=0;e<n.length;e++)u.appendChild(n[e]);else u.appendChild(n);while(t)c=r?t.previousSibling:t.nextSibling,(t.nodeType==1||t.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(""+t.data+"").length>0)&&(t.nodeType==1&&(Sys.Extended.UI.HTMLEditor.isStyleTag(t.tagName)&&t.tagName.toUpperCase()!="A"&&(!t.id||t.id!="_left_"&&t.id!="_right_")&&Sys.Extended.UI.HTMLEditor.spanJoiner(t),Sys.Extended.UI.HTMLEditor.isStyleTag(t.tagName)&&t.childNodes.length==0&&(!t.id||t.id!="_left_"&&t.id!="_right_")&&(t=null)),t&&(u.childNodes.length!=0&&r?u.insertBefore(t,u.firstChild):u.appendChild(t))),t=c;if(u.childNodes.length==0)delete u,u=null;else if(u.childNodes.length==1&&u.firstChild.nodeType==3&&(""+u.firstChild.data+"").length==0)delete u,u=null;else if(Sys.Extended.UI.HTMLEditor.isStyleTag(u.tagName)){for(s=u.childNodes.length,o=0;o<u.childNodes.length;o++)f=u.childNodes.item(o),f.nodeType!=1||Sys.Extended.UI.HTMLEditor.isStyleTag(f.tagName)||s--;if(s==0){for(h=[];u.firstChild;)f=u.removeChild(u.firstChild),h.push(f);u=h}}return i==l?u:rt(u,r?i.previousSibling:i.nextSibling,i.parentNode,r)}u=c.parentNode;c.previousSibling==null&&c.nextSibling==null&&u&&u.tagName&&u.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HTMLEditor.isStyleTag(u.tagName)&&Sys.Extended.UI.HTMLEditor.differAttr(u,["class","color","face","size"]).length>0&&(c=u);var w=rt(null,c.previousSibling,c.parentNode,!0),b=rt(null,c.nextSibling,c.parentNode,!1),r=l.parentNode;if(w){if(w.push&&typeof w.push=="function")for(a=0;a<w.length;a++)r.insertBefore(w[a],l);else r.insertBefore(w,l);Sys.Extended.UI.HTMLEditor.isIE&&(h=n._doc.getElementById("_left_"),e=n._doc.getElementById("_right_"))}if(r.insertBefore(c,l),b){if(b.push&&typeof b.push=="function")for(a=0;a<b.length;a++)r.insertBefore(b[a],l);else r.insertBefore(b,l);Sys.Extended.UI.HTMLEditor.isIE&&(h=n._doc.getElementById("_left_"),e=n._doc.getElementById("_right_"))}r.removeChild(l)}}if(ft)if(Sys.Extended.UI.HTMLEditor.isIE&&n.__saveBM__!=null){try{for(t=h.parentNode,t.removeChild(h);t&&t.childNodes.length==0;)t.parentNode.removeChild(t),t=t.parentNode;for(t=e.parentNode,t.removeChild(e);t&&t.childNodes.length==0;)t.parentNode.removeChild(t),t=t.parentNode;h=null;e=null}catch(lt){}s=n._getSelection();f=n._createRange(s);f.moveToBookmark(n.__saveBM__);f.select();n.__saveBM__=null}else n.__saveBM__!=null&&(n.__saveBM__[0].nodeType==3?(s=n._getSelection(),f=n._doc.createRange(),f.setStart(n.__saveBM__[0],n.__saveBM__[1]),f.setEnd(n.__saveBM__[0],n.__saveBM__[1]),n._removeAllRanges(s),n._selectRange(s,f)):(n._trySelect(n.__saveBM__[0],n.__saveBM__[0]),n.__saveBM__[0].parentNode.removeChild(n.__saveBM__[0])),n.__saveBM__=null);else if(Sys.Extended.UI.HTMLEditor.isIE)try{s=n._getSelection();tt=n._createRange(s);ut=n._createRange(s);tt.moveToElementText(h);ut.moveToElementText(e);tt.setEndPoint("EndToEnd",ut);tt.select()}catch(lt){}else{i=[];y=!1;function ht(n,t){while(n){if(n==e){y=!0;return}if(n.nodeType==3){while(n.nextSibling&&n.nextSibling.nodeType==3)n.data=""+n.data+""+n.nextSibling.data+"",n.parentNode.removeChild(n.nextSibling);Sys.Extended.UI.HTMLEditor.Trim(""+n.data+"").length>0&&i.push(n)}else ht(n.firstChild,!1);if(y)return;var r=n.parentNode;if(t)while(n&&n.nextSibling==null)n=n.parentNode;n=n.nextSibling}}ht(h,!0);f=n._doc.createRange();f.setStart(i[0],0);f.setEnd(i[i.length-1],(""+i[i.length-1].data+"").length);n._removeAllRanges(s);n._selectRange(s,f)}try{if(h!=null)for(t=h.parentNode,t.removeChild(h);t&&t.childNodes.length==0;)t.parentNode.removeChild(t),t=t.parentNode;if(e!=null)for(t=e.parentNode,t.removeChild(e);t&&t.childNodes.length==0;)t.parentNode.removeChild(t),t=t.parentNode}catch(lt){}n.onContentChanged();n._editPanel.updateToolbar()}},0)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);