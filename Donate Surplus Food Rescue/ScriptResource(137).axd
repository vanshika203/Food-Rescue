// (c) 2010 CodePlex Foundation
(function(){function n(){Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.PagingBulletedListBehavior=function(n){Sys.Extended.UI.PagingBulletedListBehavior.initializeBase(this,[n]);this._indexSizeValue=1;this._separatorValue=" - ";this._heightValue=null;this._maxItemPerPage=null;this._clientSortValue=!1;this._selectIndexCssClassValue=null;this._unselectIndexCssClassValue=null;this._tabValue=[];this._tabValueObject=[];this._tabIndex=[];this._divContent=null;this._divContentIndex=null;this._divContentUl=null;this._prevIndexSelected=null;this._indexSelected=0;this._clickIndex=null};Sys.Extended.UI.PagingBulletedListBehavior.prototype={initialize:function(){var u,t,r,i,f,n;for(Sys.Extended.UI.PagingBulletedListBehavior.callBaseMethod(this,"initialize"),u=this.get_ClientState(),u&&(t=u.split(";"),t.length&&(this._indexSelected=t[0],this._indexSizeValue=t[1]=="null"?null:t[1],this._maxItemPerPage=t[2]=="null"?null:t[2],this._clientSortValue=t[3]=="true"?!0:!1)),r=this.get_element(),this._divContent=document.createElement("div"),r.parentNode.insertBefore(this._divContent,r),i=r.childNodes,this._clickIndex=Function.createDelegate(this,this._onIndexClick),this._divContentIndex=document.createElement("DIV"),this._divContentIndex.style.marginBottom="5px",this._divContent.appendChild(this._divContentIndex),n=0;n<i.length;n++)i[n].nodeName=="LI"&&(f=i[n].firstChild&&i[n].firstChild.innerHTML?i[n].firstChild.innerHTML:i[n].innerHTML,this._tabValueObject[this._tabValueObject.length]={text:f,obj:i[n],index:n});this._clientSortValue&&this._tabValueObject.sort(this.liElementSortText);this._generateIndexAndTabForView();this._removeChilds(r.childNodes);this._divContentUl=document.createElement("DIV");this._changeHeightDivContent();this._divContentUl.appendChild(r);this._divContent.appendChild(this._divContentUl);this._updateIndexAndView(this._indexSelected)},_changeHeightDivContent:function(){this._heightValue?(this._divContentUl.style.overflow="scroll",this._divContentUl.style.height=this._heightValue+"px"):(this._divContentUl.style.overflow="",this._divContentUl.style.height="")},_createAHrefIndex:function(n,t){var r,i;return i=document.createElement("a"),i.href="",this._unselectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(i,this._unselectIndexCssClassValue),i.innerHTML=n,i.tag=t,$addHandler(i,"click",this._clickIndex),this._tabIndex[this._tabIndex.length]=i,this._divContentIndex.appendChild(i),r=document.createElement("SPAN"),r.innerHTML="﻿"+this._separatorValue+"﻿",this._divContentIndex.appendChild(r),r},liElementSortText:function(n,t){return n.text.toLowerCase()==t.text.toLowerCase()?0:n.text.toLowerCase()<t.text.toLowerCase()?-1:1},liElementSortIndex:function(n,t){return n.index-t.index},_generateIndexAndTabForView:function(){var i,r,n,t;if(this._deleteTabIndexAndTabValue(),this._tabValue=[],this._tabIndex=[],this._removeChilds(this._divContentIndex.childNodes),this._maxItemPerPage){if(this._maxItemPerPage>0)for(n=-1,t=0;t<this._tabValueObject.length;t++)t%this._maxItemPerPage==0&&(n++,index=this._tabValueObject[t].text,this._tabValue[n]=[],i=this._createAHrefIndex(index,n)),this._tabValue[n][this._tabValue[n].length]=this._tabValueObject[t].obj}else if(this._indexSizeValue>0)for(r="",n=-1,t=0;t<this._tabValueObject.length;t++)index=this._tabValueObject[t].text.substr(0,this._indexSizeValue).toUpperCase(),r!=index&&(n++,this._tabValue[n]=[],i=this._createAHrefIndex(index,n),r=index),this._tabValue[n][this._tabValue[n].length]=this._tabValueObject[t].obj;i&&this._divContentIndex.removeChild(i)},_deleteTabIndexAndTabValue:function(){var t,n;if(this._clickIndex){for(n=0;n<this._tabIndex.length;n++)t=this._tabIndex[n],t&&$removeHandler(t,"click",this._clickIndex);this._changeHandler=null}for(delete this._tabIndex,n=0;n<this._tabValue.length;n++)delete this._tabValue[n];delete this._tabValue},dispose:function(){this._deleteTabIndexAndTabValue();delete this._tabValueObject;Sys.Extended.UI.PagingBulletedListBehavior.callBaseMethod(this,"dispose")},_removeChilds:function(n){for(var t=0;n.length;t++)n[0].parentNode.removeChild(n[0])},_renderHtml:function(n){var i=this.get_element(),t;for(this._removeChilds(i.childNodes),t=0;t<this._tabValue[n].length;t++)i.appendChild(this._tabValue[n][t]);this._divContentUl.scrollTop=0},_selectIndex:function(n){this._tabIndex.length>0&&(this._unselectIndexCssClassValue&&Sys.UI.DomElement.removeCssClass(this._tabIndex[n],this._unselectIndexCssClassValue),this._selectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(this._tabIndex[n],this._selectIndexCssClassValue),this._prevIndexSelected=this._tabIndex[n],this.raiseIndexChanged(this._tabIndex[n]))},_onIndexClick:function(n){var i=this.get_element(),t=n.target;this._selectIndexCssClassValue&&Sys.UI.DomElement.removeCssClass(this._prevIndexSelected,this._selectIndexCssClassValue);this._unselectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(this._prevIndexSelected,this._unselectIndexCssClassValue);this._unselectIndexCssClassValue&&Sys.UI.DomElement.removeCssClass(t,this._unselectIndexCssClassValue);this._selectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(t,this._selectIndexCssClassValue);this._prevIndexSelected=t;this._renderHtml(t.tag);this.raiseIndexChanged(t);n.preventDefault()},add_indexChanged:function(n){this.get_events().addHandler("indexChanged",n)},remove_indexChanged:function(n){this.get_events().removeHandler("indexChanged",n)},raiseIndexChanged:function(n){this._indexSelected=n.tag;var t=this.get_events().getHandler("indexChanged");t&&(n||(n=Sys.EventArgs.Empty),t(this,n));this.set_ClientState(n.tag+";"+this.get_IndexSize()+";"+this.get_MaxItemPerPage()+";"+this.get_ClientSort())},get_tabIndex:function(){return this._tabIndex},get_tabValue:function(){return this._tabValue},_updateIndexAndView:function(n){this._generateIndexAndTabForView();this._tabIndex.length>0&&(n<this._tabIndex.length?(this._renderHtml(this._tabIndex[n].tag),this._selectIndex(n)):(this._renderHtml(this._tabIndex[0].tag),this._selectIndex(0)))},get_Height:function(){return this._heightValue},set_Height:function(n){this._heightValue!=n&&(this._heightValue=n,this.get_isInitialized()&&this._changeHeightDivContent(),this.raisePropertyChanged("Height"))},get_IndexSize:function(){return this._indexSizeValue},set_IndexSize:function(n){this._indexSizeValue!=n&&(this.set_ClientState("0;"+n+";"+this.get_MaxItemPerPage()+";"+this.get_ClientSort()),this._indexSizeValue=n,this.get_isInitialized()&&this._updateIndexAndView(0),this.raisePropertyChanged("IndexSize"))},get_MaxItemPerPage:function(){return this._maxItemPerPage},set_MaxItemPerPage:function(n){this._maxItemPerPage!=n&&(this.set_ClientState("0;"+this.get_IndexSize()+";"+n+";"+this.get_ClientSort()),this._maxItemPerPage=n,this.get_isInitialized()&&this._updateIndexAndView(0),this.raisePropertyChanged("MaxItemPerPage"))},get_Separator:function(){return this._separatorValue},set_Separator:function(n){this._separatorValue!=n&&(this._separatorValue=n?n:"",this.get_isInitialized()&&this._updateIndexAndView(0),this.raisePropertyChanged("Separator"))},get_ClientSort:function(){return this._clientSortValue},set_ClientSort:function(n){this._clientSortValue!=n&&(this.set_ClientState("0;"+this.get_IndexSize()+";"+this.get_MaxItemPerPage()+";"+n),this._clientSortValue=n,this.get_isInitialized()&&(this._clientSortValue?this._tabValueObject.sort(this.liElementSortText):this._tabValueObject.sort(this.liElementSortIndex),this._updateIndexAndView(0)),this.raisePropertyChanged("ClientSort"))},get_SelectIndexCssClass:function(){return this._selectIndexCssClassValue},set_SelectIndexCssClass:function(n){this._selectIndexCssClassValue!=n&&(this._selectIndexCssClassValue=n,this.raisePropertyChanged("SelectIndexCssClass"))},get_UnselectIndexCssClass:function(){return this._unselectIndexCssClassValue},set_UnselectIndexCssClass:function(n){this._unselectIndexCssClassValue!=n&&(this._unselectIndexCssClassValue=n,this.raisePropertyChanged("UnselectIndexCssClass"))}};Sys.Extended.UI.PagingBulletedListBehavior.registerClass("Sys.Extended.UI.PagingBulletedListBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.PagingBulletedListBehavior,{name:"pagedList"})}window.Sys&&Sys.loader?Sys.loader.registerScript("ExtendedPagedList",["ExtendedBase"],n):n()})();