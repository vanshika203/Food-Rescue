// (c) 2010 CodePlex Foundation
function MaskedEditSetMessage(n,t,i){n.errormessage=t;n.text=i==""?t:i;n.innerHTML=n.text}function MaskedEditMessageShow(n,t){if(typeof n.display=="string"){if(n.display=="None")return;if(n.display=="Dynamic"){n.style.display=t?"none":"inline";return}}n.style.visibility=t?"hidden":"visible"}function MaskedEditSetCssClass(n,t){var i=$get(n.TargetValidator);Sys.UI.DomElement.removeCssClass(i,n.InvalidValueCssClass);Sys.UI.DomElement.removeCssClass(i,n.CssBlurNegative);Sys.UI.DomElement.removeCssClass(i,n.CssFocus);Sys.UI.DomElement.removeCssClass(i,n.CssFocusNegative);t!=""&&Sys.UI.DomElement.addCssClass(i,t)}function MaskedEditValidatorDateTime(n){var i,t,r,o,u,f,e,c;if(MaskedEditSetMessage(n,"",""),MaskedEditSetCssClass(n,""),MaskedEditMessageShow(n,!0),n.IsMaskedEdit=="false")return!0;if(i=$get(n.TargetValidator),n.ValidEmpty=="false"&&Sys.Extended.UI.TextBoxWrapper.get_Wrapper(i).get_Value()==n.InitialValue)return MaskedEditSetMessage(n,n.EmptyValueMessage,n.EmptyValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1;if(Sys.Extended.UI.TextBoxWrapper.get_Wrapper(i).get_Value()=="")return!0;if(t=!0,r=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(i).get_Value(),n.ValidationExpression!=""&&(o=new RegExp(n.ValidationExpression),u=o.exec(r),t=u!=null&&r==u[0],!t))return MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1;var l=i.MaskedEditBehavior.AutoFormatDate(),a=i.MaskedEditBehavior.AutoFormatTime(),s="",h="";return n.MinimumValue!=""&&(s=n.MinimumValue.split(" ")[0],h=n.MinimumValue.split(" ")[1]),f="",e="",n.MaximumValue!=""&&(f=n.MaximumValue.split(" ")[0],e=n.MaximumValue.split(" ")[1]),t=MaskedEditValidatorPartDate(n,l,s,f),t&&(t=MaskedEditValidatorPartTime(n,a,h,e)),t&&n.ClientValidationFunction!=""&&(c={Value:r,IsValid:!0},eval(n.ClientValidationFunction+"(value, args);"),t=c.IsValid,t||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t||MaskedEditMessageShow(n,t),t}function MaskedEditValidatorPartTime(n,t,i,r){var s=!0,h=n.TimeSeparator,g=n.AmPmSymbol,b=g.split(";"),nt=g.replace(";","|"),tt="^(^([0][0-9]|[1][0-2])"+h+"([0-5][0-9])"+h+"([0-5][0-9])\\s("+nt+")$)|(^([0][0-9]|[1][0-2])"+h+"([0-5][0-9])\\s("+nt+")$)$",it="^(^([0-1][0-9]|[2][0-3])"+h+"([0-5][0-9])"+h+"([0-5][0-9])$)|(^([0-1][0-9]|[2][0-3])"+h+"([0-5][0-9])$)$",e=-1,v=-1,w=-1,y="",p=t.split(h),k=new RegExp(tt),c=k.exec(t),d=new RegExp(it),l=d.exec(t),u,o,a,f;return c&&c[0]==t?(y=t.substring(t.length-2).substring(0,1),e=parseInt(p[0],10),y.toUpperCase()==b[1].substring(0,1).toUpperCase()&&(e+=12,e==24&&(e=12)),v=parseInt(p[1],10),w=n.length>9?parseInt(p[2].substring(0,2),10):0):l&&l[0]==t&&(e=parseInt(p[0],10),v=parseInt(p[1],10),w=t.length>5?parseInt(p[2],10):0),(e==-1||v==-1||w==-1)&&(s=!1),s||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)),s&&(r!=""||i!="")&&(i!=""&&(u=-1,o=-1,a=-1,f=i.split(h),c=k.exec(i),l=d.exec(i),c&&c[0]==i?(y=i.substring(i.length-2).substring(0,1),u=parseInt(f[0],10),y.toUpperCase()==b[1].substring(0,1).toUpperCase()&&(u+=12,u==24&&(u=0)),o=parseInt(f[1],10),a=i.length>9?parseInt(f[2].substring(0,2),10):0):l&&l[0]==i&&(u=parseInt(f[0],10),o=parseInt(f[1],10),a=i.length>5?parseInt(f[2],10):0),s=e>u||e==u&&v>o||e==u&&v==o&&w>=a,s||(MaskedEditSetMessage(n,n.MinimumValueMessage,n.MinimumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),r!=""&&s&&(u=-1,o=-1,a=-1,f=r.split(h),c=k.exec(r),l=d.exec(r),c&&c[0]==r?(y=r.substring(r.length-2).substring(0,1),u=parseInt(f[0],10),y.toUpperCase()==b[1].substring(0,1).toUpperCase()&&(u+=12,u==24&&(u=0)),o=parseInt(f[1],10),a=r.length>9?parseInt(f[2].substring(0,2),10):0):l&&l[0]==r&&(u=parseInt(f[0],10),o=parseInt(f[1],10),a=r.length>5?parseInt(f[2],10):0),s=e<u||e==u&&v<o||e==u&&v==o&&w<=a,s||(MaskedEditSetMessage(n,n.MaximumValueMessage,n.MaximumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)))),s}function MaskedEditValidatorPartDate(n,t,i,r){var f=!0,u="MDY",y,v;switch(n.DateFormat){case"DayMonthYear":u="DMY";break;case"DayYearMonth":u="DYM";break;case"MonthDayYear":u="MDY";break;case"MonthYearDay":u="MYD";break;case"YearDayMonth":u="YDM";break;case"YearMonthDay":u="YMD"}y=n.DateSeparator;v=t.split(y);parseInt(v.length,10)!=3&&(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),f=!1);(u.indexOf("D")==-1||u.indexOf("M")==-1||u.indexOf("Y")==-1)&&(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),f=!1);var l=-1,s=-1,e=-1;if(f&&(l=parseInt(v[u.indexOf("D")],10),s=parseInt(v[u.indexOf("M")],10),e=parseInt(v[u.indexOf("Y")],10),f=l>0&&s>0&&e>0&&(l<=[,31,28,31,30,31,30,31,31,30,31,30,31][s]||l==29&&s==2&&e%4==0&&(e%100>0||e%400==0))),f||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)),f&&(r!=""||i!="")){var h,a=-1,c=-1,o=-1;i!=""&&(h=i.split(y),a=parseInt(h[u.indexOf("D")],10),c=parseInt(h[u.indexOf("M")],10),o=parseInt(h[u.indexOf("Y")],10),f=a>0&&c>0&&o>0&&e>o||e==o&&s>c||e==o&&s==c&&l>=a,f||(MaskedEditSetMessage(n,n.MinimumValueMessage,n.MinimumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)));f&&r!=""&&(h=r.split(y),a=parseInt(h[u.indexOf("D")],10),c=parseInt(h[u.indexOf("M")],10),o=parseInt(h[u.indexOf("Y")],10),f=a>0&&c>0&&o>0&&e<o||e==o&&s<c||e==o&&s==c&&l<=a,f||(MaskedEditSetMessage(n,n.MaximumValueMessage,n.MaximumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)))}return f}function MaskedEditValidatorDate(n){var r,t,i,f,u,e;return(MaskedEditSetMessage(n,"",""),MaskedEditSetCssClass(n,""),MaskedEditMessageShow(n,!0),n.IsMaskedEdit=="false")?!0:(r=$get(n.TargetValidator),n.ValidEmpty=="false"&&Sys.Extended.UI.TextBoxWrapper.get_Wrapper(r).get_Value()==n.InitialValue)?(MaskedEditSetMessage(n,n.EmptyValueMessage,n.EmptyValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1):Sys.Extended.UI.TextBoxWrapper.get_Wrapper(r).get_Value()==""?!0:(t=!0,i=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(r).get_Value(),n.ValidationExpression!=""&&(f=new RegExp(n.ValidationExpression),u=f.exec(i),t=u!=null&&i==u[0],!t))?(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1):(t=MaskedEditValidatorPartDate(n,i,n.MinimumValue,n.MaximumValue),t&&n.ClientValidationFunction!=""&&(e={Value:i,IsValid:!0},eval(n.ClientValidationFunction+"(value, args);"),t=e.IsValid,t||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t||MaskedEditMessageShow(n,t),t)}function MaskedEditValidatorTime(n){var r,t,i,f,u,e;return(MaskedEditSetMessage(n,"",""),MaskedEditSetCssClass(n,""),MaskedEditMessageShow(n,!0),n.IsMaskedEdit=="false")?!0:(r=$get(n.TargetValidator),n.ValidEmpty=="false"&&Sys.Extended.UI.TextBoxWrapper.get_Wrapper(r).get_Value()==n.InitialValue)?(MaskedEditSetMessage(n,n.EmptyValueMessage,n.EmptyValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1):Sys.Extended.UI.TextBoxWrapper.get_Wrapper(r).get_Value()==""?!0:(t=!0,i=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(r).get_Value(),n.ValidationExpression!=""&&(f=new RegExp(n.ValidationExpression),u=f.exec(i),t=u!=null&&i==u[0],!t))?(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1):(t=MaskedEditValidatorPartTime(n,i,n.MinimumValue,n.MaximumValue),t&&n.ClientValidationFunction!=""&&(e={Value:i,IsValid:!0},eval(n.ClientValidationFunction+"(value, args);"),t=e.IsValid,t||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t||MaskedEditMessageShow(n,t),t)}function MaskedEditValidatorNumber(n){var o,s,a,h,v;if(MaskedEditSetMessage(n,"",""),MaskedEditSetCssClass(n,""),MaskedEditMessageShow(n,!0),n.IsMaskedEdit=="false")return!0;if(o=$get(n.TargetValidator),s=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(o).get_Value().replace(new RegExp("([w_.,s$ ])","g"),""),n.ValidEmpty=="false"&&s==n.InitialValue)return MaskedEditSetMessage(n,n.EmptyValueMessage,n.EmptyValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1;if(s=="")return!0;var t=!0,y=n.Thousands,p=n.Decimal,l=n.Money,w=n.LastMaskPosition+l.length+1,u=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(o).get_Value();if(n.ValidationExpression!=""&&(a=new RegExp(n.ValidationExpression),h=a.exec(u),t=h!=null&&u==h[0],!t))return MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1;t=!1;var c=null,e=null,r=null,f=null,i=null;return u=u.replace(new RegExp("(\\"+y+")","g"),""),u=u.replace(new RegExp("(\\"+l+")","g"),""),r=u.match(/^\s*(\S+(\s+\S+)*)\s*$/),r!=null&&(u=r[1]),e=/^\s*[-\+]?\d+\s*$/,u.match(e)!=null&&(f=parseInt(u,10),t=f==(isNaN(f)?null:f)),t?(n.MaximumValue!=""&&(i=parseInt(n.MaximumValue,10),i==(isNaN(i)?null:i)&&f>i&&(t=!1,MaskedEditSetMessage(n,n.MaximumValueMessage,n.MaximumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t&&n.MinimumValue!=""&&(i=parseInt(n.MinimumValue,10),i==(isNaN(i)?null:i)&&f<i&&(t=!1,MaskedEditSetMessage(n,n.MinimumValueMessage,n.MinimumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)))):(e=new RegExp("^\\s*([-\\+])?(\\d+)?(\\"+p+"(\\d+))?\\s*$"),r=u.match(e),r!=null&&(c=null,c=typeof r[1]!="undefined"?r[1]+(r[2].length>0?r[2]:"0")+"."+r[4]:(r[2].length>0?r[2]:"0")+"."+r[4],f=parseFloat(c),t=f==(isNaN(f)?null:f)),t||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass)),t&&(n.MaximumValue!=""&&(i=parseFloat(n.MaximumValue),i==(isNaN(i)?null:i)&&f>i&&(t=!1,MaskedEditSetMessage(n,n.MaximumValueMessage,n.MaximumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t&&n.MinimumValue!=""&&(i=parseFloat(n.MinimumValue),i==(isNaN(i)?null:i)&&f<i&&(t=!1,MaskedEditSetMessage(n,n.MinimumValueMessage,n.MinimumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))))),t&&n.ClientValidationFunction!=""&&(v={Value:u,IsValid:!0},eval(n.ClientValidationFunction+"(value, args);"),t=v.IsValid,t||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t||MaskedEditMessageShow(n,t),t}function MaskedEditValidatorNone(n){var u,t,r,o,f,e,i,s;return(MaskedEditSetMessage(n,"",""),MaskedEditSetCssClass(n,""),MaskedEditMessageShow(n,!0),n.IsMaskedEdit=="false")?!0:(u=$get(n.TargetValidator),n.ValidEmpty=="false"&&Sys.Extended.UI.TextBoxWrapper.get_Wrapper(u).get_Value()==n.InitialValue)?(MaskedEditSetMessage(n,n.EmptyValueMessage,n.EmptyValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1):Sys.Extended.UI.TextBoxWrapper.get_Wrapper(u).get_Value()==""?!0:(t=!0,r=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(u).get_Value(),n.ValidationExpression!=""&&(o=new RegExp(n.ValidationExpression),f=o.exec(r),t=f!=null&&r==f[0],!t))?(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass),MaskedEditMessageShow(n,!1),!1):(e=/^\d+\s*$/,i=null,n.MaximumValue!=""&&n.MaximumValue.match(e)!=null&&(i=parseInt(n.MaximumValue,10),i==(isNaN(i)?null:i)&&r.length>i&&(t=!1,MaskedEditSetMessage(n,n.MaximumValueMessage,n.MaximumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t&&n.MinimumValue!=""&&n.MinimumValue.match(e)!=null&&(i=parseInt(n.MinimumValue,10),i==(isNaN(i)?null:i)&&r.length<i&&(t=!1,MaskedEditSetMessage(n,n.MinimumValueMessage,n.MinimumValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t&&n.ClientValidationFunction!=""&&(s={Value:r,IsValid:!0},eval(n.ClientValidationFunction+"(value, args);"),t=s.IsValid,t||(MaskedEditSetMessage(n,n.InvalidValueMessage,n.InvalidValueText),MaskedEditSetCssClass(n,n.InvalidValueCssClass))),t||MaskedEditMessageShow(n,t),t)}